#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include <time.h>

// Função para calcular a probabilidade de captura
double calcularProbabilidadeCaptura(int taxaDeCaptura) {
    double alpha = log(0.2) / -255; // Calculando o valor de alpha

    // Usando a fórmula para calcular a probabilidade de sucesso
    double probabilidade = 1 - exp(-alpha * taxaDeCaptura);

    return probabilidade;
}

int main() {
    int tentativas = 3; // Número de tentativas

    // Inicialize a semente para geração de números aleatórios
    srand(time(NULL));

    int continuarJogando = 1; // Variável para controlar se o jogador quer continuar jogando

    while (continuarJogando) {
        printf("Você tem 3 chances para capturar o Pokemon!\n");

        for (int i = 0; i < tentativas; i++) {
            int taxaDeCaptura;
            printf("Digite a taxa de captura do Pokemon (0 a 255) para a tentativa %d: ", i + 1);
            scanf("%d", &taxaDeCaptura);

            if (taxaDeCaptura >= 0 && taxaDeCaptura <= 255) {
                double probabilidade = calcularProbabilidadeCaptura(taxaDeCaptura);
                printf("A probabilidade de sucesso na captura é: %.2f%%\n", probabilidade * 100);

                // Gere um número aleatório entre 0 e 100 para simular o resultado da captura
                int resultadoCaptura = rand() % 101;

                if (resultadoCaptura <= probabilidade * 100) {
                    printf("Tentativa %d - Você conseguiu capturar o Pokemon com sucesso!\n", i + 1);
                    break; // Saia do loop de tentativas se a captura for bem-sucedida
                } else {
                    printf("Tentativa %d - A captura falhou. O Pokemon escapou.\n", i + 1);
                }
            } else {
                printf("A taxa de captura deve estar no intervalo de 0 a 255. Tente novamente.\n");
            }
        }

        printf("Deseja tentar mais uma vez? (1 para Sim, 0 para Não): ");
        scanf("%d", &continuarJogando);
    }

    printf("Obrigado por jogar! Encerrando o programa.\n");

    return 0;
}
